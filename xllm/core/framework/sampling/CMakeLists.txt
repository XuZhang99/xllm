include(cc_library)
include(cc_test)

cc_library(
  NAME 
    sampler
  HDRS
    sampling_params.h
    logits_utils.h
    rejection_sampler.h
    sampler.h
  SRCS
    sampling_params.cpp
    logits_utils.cpp
    rejection_sampler.cpp
    sampler.cpp
  DEPS
    glog::glog
    torch
    $<$<BOOL:${USE_NPU}>:xllm_ops>
)

cc_test(
  NAME
    sampler_test
  SRCS
    rejection_sampler_test.cpp
    rejection_sampler.cpp
    sampling_params_test.cpp
  DEPS
    GTest::gtest_main
    :sampler
)
